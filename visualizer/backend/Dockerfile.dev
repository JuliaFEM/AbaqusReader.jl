FROM julia:1.11

# Set working directory
WORKDIR /app

# Copy the entire AbaqusReader.jl source
COPY ../../ /AbaqusReader

# Copy server
COPY server.jl .

# Install dependencies and add AbaqusReader from local path
RUN julia -e 'using Pkg; Pkg.add(["HTTP", "JSON3"]); Pkg.develop(path="/AbaqusReader")'

# Expose port
EXPOSE 8080

# Run server
CMD ["julia", "server.jl"]
